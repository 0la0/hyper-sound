<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS-Sound Example</title>
    <style>
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background-color: #242424;
        color: #CCC;
        font-family: helvetica, arial, sans-serif;
        font-size: 12px;
        overflow: hidden;
      }
      .toggle-button {
        position: absolute;
        right: 0;
        top: 0;
        padding: 8px;
        margin: 8px;
        background: unset;
        color: #CCC;
        border: 2px solid #CCC;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </head>
  <script src="./ps-pattern/dist/pspattern.js"></script>
  <script src="./pssound.js"></script>
  <script>
    let isOn = false;
    function toggle() {
      isOn = !isOn;
      const event = new CustomEvent(isOn ? 'CLOCK_START' : 'CLOCK_STOP');
      document.dispatchEvent(event);
    }
  </script>
  <body>

    <button class="toggle-button" onclick="toggle(event)">toggle</button>

    <div>

      <ps-dac>
        <!-- <ps-filter type="lowpass" frequency="440" q="1" gain="1"> -->
          <ps-tape-delay delay="0.120" feedback="0.8" wet="0.8">
            <ps-gain value="0.1">
              <ps-env-osc wav="squ" attack="0" sustain="0" release="40" trigger="a"></ps-env-osc>
            </ps-gain>
          </ps-tape-delay>
          <!-- <ps-gain value="0.2">
            <ps-env-osc wav="squ" attack="0" sustain="0" release="40" trigger="a"></ps-env-osc>
          </ps-gain> -->
        <!-- </ps-filter> -->
      </ps-dac>

      <!-- <ps-gain value="100" id="testmod">
        <ps-env-osc wav="sin" attack="0" sustain="0" release="200" trigger="b"></ps-env-osc>
      </ps-gain> -->

      <ps-seq>
        <ps-pat-mod speed="1" degrade="1">
          <ps-pat-midi pattern="a:52 a:60 , a:72"></ps-pat-midi>
          <ps-pat-midi pattern="a a a"></ps-pat-midi>
          <!-- <ps-pat-midi pattern="a"></ps-pat-midi> -->
        </ps-pat-mod>
      </ps-seq>

      <!-- <ps-dac>
        <ps-gain value="0.06">
          <ps-osc wav="sin" frequency="440"></ps-osc>
        </ps-gain>
      </ps-dac> -->
    </div>

  </body>
</html>
